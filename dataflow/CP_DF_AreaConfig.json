{
	"name": "CP_DF_AreaConfig",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Source_Table",
						"type": "DatasetReference"
					},
					"name": "OLTPDataSource"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Destination_Table",
						"type": "DatasetReference"
					},
					"name": "OLAPDimensionLoad"
				}
			],
			"transformations": [
				{
					"name": "AlterRow"
				},
				{
					"name": "StatusFilter"
				},
				{
					"name": "FormatString",
					"description": "This Derived Column activity ensures consistent formatting by trimming leading and trailing spaces from all string columns. Additionally, it capitalizes only the first letter of each value while keeping the rest of the text unchanged. This transformation helps maintain standardized data before further processing\n"
				},
				{
					"name": "SetDefaultValues",
					"description": "This step is responsible for assigning default values to specific columns before loading data into the destination table. It ensures consistency in historical tracking and simplifies downstream processing."
				}
			],
			"scriptLines": [
				"source(output(",
				"          Business_Unit_ID as integer,",
				"          Business_Unit as string,",
				"          Block_ID as string,",
				"          Area_Classification_1 as string,",
				"          Area_Classification_2 as string,",
				"          Plant_ID as string,",
				"          Plant_ID2 as string,",
				"          Asset_Owner as string,",
				"          Cost_Center as string,",
				"          Tier_Classification as string,",
				"          Comments as string,",
				"          Business_Justification as string,",
				"          Attachments as string,",
				"          Status as string,",
				"          Field_Engineer as string,",
				"          Field_Engineer_Remarks as string,",
				"          Approver_1_Name as string,",
				"          Approver_1_Remarks as string,",
				"          Approver_1_Timestamp as timestamp,",
				"          Approver_2_Name as string,",
				"          Approver_2_Remarks as string,",
				"          Approver_2_Timestamp as timestamp,",
				"          Created_By as string,",
				"          Created_Timestamp as timestamp,",
				"          Updated_By as string,",
				"          Updated_Timestamp as timestamp",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> OLTPDataSource",
				"StatusFilter alterRow(upsertIf(!isNull(Business_Unit_ID)),",
				"     insertIf(isNull(Business_Unit_ID))) ~> AlterRow",
				"FormatString filter(Status == 'Approved') ~> StatusFilter",
				"OLTPDataSource derive(Block_ID = upper(left(trim(Block_ID), 1)) + right(trim(Block_ID), length(trim(Block_ID)) - 1),",
				"          Business_Unit = upper(left(trim(Business_Unit), 1)) + right(trim(Business_Unit), length(trim(Business_Unit)) - 1),",
				"          Area_Classification_1 = upper(left(trim(Area_Classification_1), 1)) + right(trim(Area_Classification_1), length(trim(Area_Classification_1)) - 1),",
				"          Area_Classification_2 = upper(left(trim(Area_Classification_2), 1)) + right(trim(Area_Classification_2), length(trim(Area_Classification_2)) - 1),",
				"          Plant_ID = upper(left(trim(Plant_ID), 1)) + right(trim(Plant_ID), length(trim(Plant_ID)) - 1),",
				"          Plant_ID2 = upper(left(trim(Plant_ID2), 1)) + right(trim(Plant_ID2), length(trim(Plant_ID2)) - 1),",
				"          Tier_Classification = upper(left(trim(Tier_Classification), 1)) + right(trim(Tier_Classification), length(trim(Tier_Classification)) - 1),",
				"          Asset_Owner = upper(left(trim(Asset_Owner), 1)) + right(trim(Asset_Owner), length(trim(Asset_Owner)) - 1),",
				"          Cost_Center = upper(left(trim(Cost_Center), 1)) + right(trim(Cost_Center), length(trim(Cost_Center)) - 1),",
				"          Comments = upper(left(trim(Comments), 1)) + right(trim(Comments), length(trim(Comments)) - 1),",
				"          Field_Engineer = upper(left(trim(Field_Engineer), 1)) + right(trim(Field_Engineer), length(trim(Field_Engineer)) - 1),",
				"          Approver_1_Name = upper(left(trim(Approver_1_Name), 1)) + right(trim(Approver_1_Name), length(trim(Approver_1_Name)) - 1),",
				"          Field_Engineer_Remarks = upper(left(trim(Field_Engineer_Remarks), 1)) + right(trim(Field_Engineer_Remarks), length(trim(Field_Engineer_Remarks)) - 1),",
				"          Approver_1_Remarks = upper(left(trim(Approver_1_Remarks), 1)) + right(trim(Approver_1_Remarks), length(trim(Approver_1_Remarks)) - 1),",
				"          Approver_2_Name = upper(left(trim(Approver_2_Name), 1)) + right(trim(Approver_2_Name), length(trim(Approver_2_Name)) - 1),",
				"          Approver_2_Remarks = upper(left(trim(Approver_2_Remarks), 1)) + right(trim(Approver_2_Remarks), length(trim(Approver_2_Remarks)) - 1),",
				"          Business_Justification = upper(left(trim(Business_Justification), 1)) + right(trim(Business_Justification), length(trim(Business_Justification)) - 1)) ~> FormatString",
				"AlterRow derive(Begin_Date = currentUTC(),",
				"          End_Date = toDate('9999-12-31', 'yyyy-MM-dd'),",
				"          Current_Rec_In = 1) ~> SetDefaultValues",
				"SetDefaultValues sink(allowSchemaDrift: true,",
				"     validateSchema: true,",
				"     input(",
				"          Business_Unit_KEY as integer,",
				"          Business_Unit as string,",
				"          Block_ID as string,",
				"          Area_Classification_1 as string,",
				"          Area_Classification_2 as string,",
				"          Plant_ID as string,",
				"          Plant_ID2 as string,",
				"          Asset_Owner as string,",
				"          Cost_Center as string,",
				"          Tier_Classification as string,",
				"          Comments as string,",
				"          Business_Justification as string,",
				"          Attachments as string,",
				"          Begin_Date as date,",
				"          End_Date as date,",
				"          Current_Rec_In as integer,",
				"          Field_Engineer_Name as string,",
				"          Field_Engineer_Remarks as string,",
				"          Approver_1_Name as string,",
				"          Approver_1_Remarks as string,",
				"          Approver_1_Timestamp as timestamp,",
				"          Approver_2_Name as string,",
				"          Approver_2_Remarks as string,",
				"          Approver_2_Timestamp as timestamp,",
				"          Created_By as string,",
				"          Created_Timestamp as timestamp,",
				"          Updated_By as string,",
				"          Updated_Timestamp as timestamp",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:true,",
				"     keys:['Business_Unit_KEY'],",
				"     format: 'table',",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          Business_Unit_KEY = Business_Unit_ID,",
				"          Business_Unit,",
				"          Block_ID,",
				"          Area_Classification_1,",
				"          Area_Classification_2,",
				"          Plant_ID,",
				"          Plant_ID2,",
				"          Asset_Owner,",
				"          Cost_Center,",
				"          Tier_Classification,",
				"          Comments,",
				"          Business_Justification,",
				"          Attachments,",
				"          Begin_Date,",
				"          End_Date,",
				"          Current_Rec_In,",
				"          Field_Engineer_Name = Field_Engineer,",
				"          Field_Engineer_Remarks,",
				"          Approver_1_Name,",
				"          Approver_1_Remarks,",
				"          Approver_1_Timestamp,",
				"          Approver_2_Name,",
				"          Approver_2_Remarks,",
				"          Approver_2_Timestamp,",
				"          Created_By,",
				"          Created_Timestamp,",
				"          Updated_By,",
				"          Updated_Timestamp",
				"     )) ~> OLAPDimensionLoad"
			]
		}
	}
}